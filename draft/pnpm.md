

# pnpm

想利用它的一些优势

- 快速 pnpm i --prefer-offline
- workspace 
- publishConfig

整体体验很不错。


之前遇到的问题，我们有一个私有的npm包，这个包里面目前看来，有两块大的内容。

经过我的改造之后，将原来的一个包，改成了多个包，那么他的优势在哪里呢？

# monorepo

monoRepo 这个概念近几年还蛮流行的，几个包，甚至是几个项目，在同一个repo里面管理，共享同一份代码，彼此之间有一定的联系，但是这些项目间又彼此独立。

说起来，我在刚刚来到这个公司大概半年多之后，就有过想要把两个项目放在同一个repo里这样的想法，只是当时没有想到这样的学术名词，也没有一些好的技术方案。

借助pnpm，其实是可以梳理成章地完成这些的。

我们之前要用刚刚说到那两块内容，比如A和B，我们的做法是在webpack里面写Alias，以及在tsconfig里面去做alias，将这两个用alias的方式去作为两个独立的内容去看待。这样做有什么问题呢？当然是有问题的，也就是说业务的项目已经对第三方的包有了感知，这种感知并不是优雅的。这也是我比较不太能够接受的。

而经过我改造之后，虽然我分拆成了多个包，但是我最后还是将这些分拆的包，放在了一个影子包里面。

monorepo借由pnpm的workspace方便地实现，同时也方便我们去进行开发和调试。

# 分拆包之后，更多的新包出现

原本在一个包里面只有两个包，A和B，但是经过对项目的分析，我又添加了几个新包。每个包，都因为这种monorepo的概念，而显得非常合适。比如新添加的C包，就是一个导出umd，去做微前端项目间进行通讯的包。再来说，新添加的D包，就是一个脚本包，这个脚本包，就能够把几个项目里都用到的脚本整合在这里，避免代码的重复，利于维护。

