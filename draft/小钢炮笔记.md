斐讯N1 刷入小钢炮系统后的注意事项

# 0. 小钢炮系统

http://rom.nanodm.net/

你可以在小钢炮的官网看到最新的系统

# 1. 系统网络改静态路由（system network）

我们刚刚拿到一台N1盒子之后，刷入了小钢炮，这个时候，我们通过网线直连的方式将N1盒子接入的网络中，由于ip地址是DHCP，所以我们需要登陆到路由器后台，才可以看到小钢炮的ip地址，进而登陆系统。但是我们不想每次都这么麻烦，所以需要将系统网络改为静态ip，这样我们只需要记住一个内网ip的地址就可以了。

例如，我的主路由地址是`192.168.31.1`, 我想给小钢炮分配的ip地址为`192.168.31.36`

就可以在`system/network` 中进行相关修改。


# 2. 计划任务

可以直接在图形界面中编写相应的`crontab`添加或编辑计划任务，具体是`System/Scheduled Tasks`

在这里，可以看到其实已经有了一条给aria2添加tracker的计划任务，我们只需要给它前面的`#`去掉即可

```
0 * * * */7 /usr/local/bin/addtracker-aria2
```

当然了，我们这个计划任务是给aria2添加最新的tracker， 如果我们想要立刻添加tracker，而不通过计划任务的话，则只需要执行：

`/usr/local/bin/addtracker-aria2`

需要注意的是，由于这个脚本里面的远程地址是`*.githubusercontent.com` ，因此可能无法访问，获取不到最新的tracker，我自己就遇到了这种情况，报了404.

解决办法，可以像这篇文章写的那样，在`/etc/hosts` 里面添加一行

`199.232.96.133    raw.githubusercontent.com`

再次执行上述脚本，就没有问题了。需要注意的是，当脚本执行完毕后，会写系统日志，系统日志可以在小钢炮的界面上查看（`状态/系统日志`），也可以通过命令行找到

系统日志存储位置：

`/var/log/messages.`


# 3 config docker 下载地址

修改小钢炮docker 下载地址

`vi /etc/docker/daemon.json`

添加一行

`"graph": "/media/1ae6b9fc-47bd-47e6-b403-bba26910b79e/download"`

为啥要这么做呢？因为我使用了外置的移动硬盘，我当然想把docker的存储路径改到这里，这样我就可以安装更多的docker应用，同样的道理，我也可以把我的aria2或者qb的下载路径指定到我的移动硬盘，只不过，由于修改docker下载地址，需要使用命令行，容易被忽视，所以在这里，单独拿出来说下。

# 4 配置docker openwrt


`docker network create -d macvlan --subnet=192.168.31.0/24 --gateway=192.168.31.1 -o parent=eth0 macnet`


# 2.启动项设置 
start up



#!/bin/sh
# this script will be executed during boot.

touch /var/lock/subsys/local
ip link set eth0 promisc on
ip link add mynet link eth0 type macvlan mode bridge 
ip addr add 192.168.31.10 dev mynet
ip link set mynet up
ip route add 192.168.31.18 dev mynet


