2020.06.27

## 前提


我是喜欢做一些前端优化相关的工作的，最近又做了一些，也踩了一些坑。于是就分享记录一下。

## 之前遇到的问题

之前遇到的显著问题是由于历史债，或者说为了省事，在做一些webpack相关的流程的时候，采用了在入口处将所有资源都打出去的做法。然后将一些体积比较大的npm包，或者用处比较多的npm包，通过webpack的external方式来分离出去，通过这样的操作，让主入口的index.js文件尽可能地小。

这样的做法有什么优缺点呢？

优点:

只需要一个index.js文件，其他的资源都可以通过external的方式获取。

用户从着陆页跳转到其他的页面的时候，只要是在SPA之下，就无需再请求webpack打包后的其他资源，这样地话，打开这些页面会很快，因为资源早就预先加载过了。

缺点：

由于将整个项目中用到的所有资源都打包到了入口中（除了external的资源），致使有一些页面，尽管并不会被用户访问，也已经直接在打包的文件中了。那必然导致，这个index.js 体积很大，那么如何解决这个问题呢?




举一个形象的例子，当时的做法就是费了很大的力气，我用卡车拉了一车的水果到你家门口，西瓜，苹果，大鸭梨，应有尽有。你想要什么水果，我能够立刻就把你要的水果给到你。但是，我可能只是想要两个苹果，你却要为此浪费那么多汽油。



我的方案，其实是一个通用的方案，也就是React 官方文档推荐的[code-splitting](https://zh-hans.reactjs.org/docs/code-splitting.html) 的方式，用到了`Suspense` 以及`Lazy` 这两个方法来实现。

其他的，也就是Webpack 4中配置[dynamic-imports](https://webpack.js.org/guides/code-splitting/#dynamic-imports) 的方法了。

这里需要解释的是，其实我早在上家公司的时候，就已经使用这样的方式来进行code spliting。 之所以这次又做了这方面的工作，也是因为当前公司项目的一些技术债。

## 一个项目，多个项目

我来这家公司之前，对微前端只停留在认知层面，并没有太多了解。后来，来到这家公司，慢慢地发现原来还有我们这样的项目。

产品究竟是什么







在webpack官方的文档中，对这两


https://webpack.js.org/guides/code-splitting/

在此之前，已经有同事做了大量的工作，他的大体思路是